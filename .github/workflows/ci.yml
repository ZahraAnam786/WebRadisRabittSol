# This workflow will build a .NET project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-net

name: .NETProWorkFlow

on:
  workflow_dispatch: #this is for permission
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
     
env: #example for env
 AZURE_WEBAPPNAME: any
 AZURE_WEBAPP_PACKAGE_PATH: "./WebRadisRabittPro/publish"
 DOTNET_VERSION: "9.X"
 SOLUTION_PATH: "WebRadisRabittSol.sln"
 API_PROJECT_PATH: "WebRadisRabittPro"
 PUBLISH_DIR: "./publish"

jobs:
  #build and test:
  build:
    name: Build and Test
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
  
    # - name: Setup .NET
    #   uses: actions/setup-dotnet@v4
    #   with:
    #     dotnet-version: ${{env.DOTNET_VERSION}}

    # - name: Restore dependencies
    #   run: dotnet restore ${{env.SOLUTION_PATH}}

    # - name: Build
    #   run: dotnet build ${{env.SOLUTION_PATH}} --configuration Release --no-restore
    
    # - name: Test
    #   run: dotnet test ${{env.SOLUTION_PATH}} --configuration Release --no-restore --no-build --verbosity normal

    # - name: Publish
    #   run: dotnet publish ${{env.API_PROJECT_PATH}} --c Release --no-restore --no-build --property:PublishDir=${{env.PUBLISH_DIR}}
    
    - name: Login to Docker Hub
      uses: docker/login-action@v2
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}

    - name: Build Docker Image
      run: docker build -t anamzahra786/WebRadisRabittPro:latest .

    - name: Push Docker Image
      run: docker push anamzahra786/WebRadisRabittPro:latest
    # - name: Publish Artifacts
    #   uses: actions/upload-artifact@v4
    #   with:
    #    name: webapp
    #    path: ${{env.AZURE_WEBAPP_PACKAGE_PATH}}

  # deploy:
  #   name: Deploy to AZURE
  #   runs-on: ubuntu-latest
  #   needs: [build and test]

  #   steps:
  #   - name: Download artifacts from build jobs
  #     uses: actions/download-artifact@v4
  #     with:
  #      name: webapp
  #      path: ${{env.AZURE_WEBAPP_PACKAGE_PATH}}

  #   - name: Deploy
  #     uses: azure/webapps-deploy@v2
  #     with:
  #      app-name: ${{env.AZURE_WEBAPPNAME}}
  #      publish-profile: ${{secret.AZURE_WEBAPP_PUBLISH_PROFILE}}
  #      package: "${{env.AZURE_WEBAPP_PACKAGE_PATH}}"
